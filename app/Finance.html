<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="stylesheet.css" media="screen" />
<title>Talquee Bank - Cadastro</title>
</head>
<body>
    <h1 class="text-color">Cadastro</h1>
    <div class="container">
        <ul class="steps">
            <li class="">Dados Básicos</li>
            <li class="">Dados de Endereço</li>
            <li class="active">Dados Financeiros</li>
            <li class="">Senha</li>
        </ul>
    <form id="financeForm">
        <label for="renda">Renda:</label>
        <input type="number" id="renda" name="renda" step="0.01" required><br><br>
        <label for="patrimonio">Patrimônio:</label>
        <input type="number" id="patrimonio" name="patrimonio" step="0.01" required><br><br>
        <button type="submit">Próximo</button>
    </form>

    <script>
        document.getElementById('financeForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const renda = parseFloat(document.getElementById('renda').value);
            const patrimonio = parseFloat(document.getElementById('patrimonio').value);

            if (renda + patrimonio < 1000) {
                alert('A soma de Renda e Patrimônio deve ser maior ou igual a 1000.');
                return;
            }

            const clientId = localStorage.getItem('ClientId');

            const requestBody = JSON.stringify({
                Renda: renda,
                Patrimonio: patrimonio
            });

            fetch('http://localhost:5148/api/registration/Finance', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'ClientId': clientId
                },
                body: requestBody
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Erro na requisição: ' + response.statusText);
                }
                return response.text();
            })
            .then(() => {
                window.location.href = 'Password.html';
            })
            .catch(error => {
                console.error('Erro ao adicionar dados finaceiros:', error);
                alert("Ocorreu um erro ao adicionar os dados finaceiros. Verifique o console para mais detalhes.");
            });
        });
    </script>
</body>
</html>
